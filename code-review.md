## Общие проблемы

1. Юнит-тесты? 
2. Добавить `composer.lock`, чтобы зафиксировать используемые версии пакетов
3. Мешанина из promoted-property и старых конструкторов и модификаторов readonly. Лучше использовать однообразную схему. 
3. Избыточная область видимости свойств и методов
4. Контракты методов/конструкторов не проставлены или слишком жидкие

## Датальнее

#### CartView

1. Путаница с ценой строки и ценой корзины. 
2. За товарами в репозиторий нужно ходить одним запросом, а не множеством.
3. Ключ items можно инициализировать вместе с прочими ключами ответа.

#### JsonResponse

1. `Content-Type` всегда один, перенести в конструктор, чтобы не заставлять клиентов

#### ConnectorException

1. Слишком общий предок. Может скрывать за собой даже `TypeError`. Лучше использовать `\Expection`.
2. Кастомные реализации уйдут при наследовании от `\Exception`. Можно убрать.

#### CartManager (и его предок ConnectorFacade)

1. Вызывает `ConnectorFacade::build` в конструкторе, который устанавливает соединение когда мы даже не начали работу.
2. Пользует свойство `connector` от предка и не использует его умение делать reconnect. Просто расселить эту часть. 
3. Зависимость `LoggerInterface` оформлена через сеттер. Хорошо использовать общий подход через autowiring в конструктор.
3. Логируется только строка "Error" без детальной информации что за проблема.
4. Знает о `session_id()`, должен использовать менеджер сессий, который скажет какой у сессии id
5. Метод `getCart` говорит, что если корзины нет, то возвращать `null`, а не пустую корзину
6. `ConnectorFacade.build` фактически делает ping в конструкторе, хотя это для поддержания уже установленного соединеня. На мороз.

#### Repository/ProductRepository (стал DbalProductRepository)

1. Уязвим к SQL-инъекциям. Нужно использовать именованные параметры.
2. Метод `getByCategory` пытается воссоздать товар считывая из БД только одну колонку `id`
3. У нас "strict_types", а значит метод `make` будет фаталить т.к. считывает из БД в виде строк, а пытается манипулировать int, float и bool

#### Infrastructure/Connector (стал RedisAwareKeyValueStorage)

1. Не логирует ошибки, что есть в требованиях задачи
2. Текст сообщения об ошибке не поясняет что случилось
3. В сервис проситься проверка доступности соединения. 

#### migrations/schema.init.sql

1. Нет индекса по колонкам `uuid` и `category` хотя они используется для фильтрации. 
2. Колонки `id` и `uuid` избыточны. `uuid` можно обозвать уникальным, а `id` больше нигде не используется.
3. Колонка `category` выглядит как часть денормализации данных. Завести таблицу `category` и ссылаться на неё по `category_id`. Индекс на `category_id`.
4. Скорее всего индекс по `is_active` бесполезный т.к. низкоселективный. Обычно все товары "активны".
5. Коммент 'Тип услуги' -> 'Название услуги'
6. Название колонки `name` не удачное. У товаров нет имён. Есть названия.